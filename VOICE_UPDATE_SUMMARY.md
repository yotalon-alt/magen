# עדכון מערכת הפקודות הקוליות

## 🎯 מה השתנה?

העוזרת הקולית שודרגה ל**זיהוי מבוסס Intent** במקום משפטים קשיחים.

---

## ✨ תכונות חדשות

### 1. פקודות גלובליות (עובדות מכל דף)
- "חזור אחורה" → Navigator.pop()
- "לך לדף הבית" → מעבר לדף הבית
- "תראה לי את כל המשובים" → מעבר לדף משובים
- "פתח סטטיסטיקה" → מעבר לדף סטטיסטיקה

### 2. פקודות חיפוש וניווט במשובים
- "כנס למשוב ראשון" → פותח את המשוב הקדום ביותר
- "כנס למשוב אחרון" → פותח את המשוב האחרון
- **"חפש משוב של [שם]"** → מחפש משוב לפי שם נבדק (חילוץ דינמי!)
- "סגור משוב" → חוזר אחורה מהמשוב

### 3. פקודות חישוב בסטטיסטיקה
- **"כמה משובים יש"** → מציג סך כל המשובים
- **"כמה משובים יש לקורס מדריכים"** → מציג משובי קורס מדריכים
- **"כמה משובים יש בתרגיל הזה"** → מציג משובים לתרגיל הנוכחי
- **"אפס סינונים"** → מאפס את כל הסינונים בסטטיסטיקה

### 4. חילוץ פרמטרים דינמי
העוזרת יכולה כעת לחלץ שמות ונתונים מתוך הפקודה:
```
"חפש משוב של דני" → שם: "דני"
"סנן לפי יישוב באר שבע" → יישוב: "באר שבע"
```

---

## 🔧 שינויים טכניים

### voice_assistant.dart
- **הוספת פונקציית עזר:** `_matchIntent()` לזיהוי Intent
- **הוספת פונקציית עזר:** `_extractParameter()` לחילוץ פרמטרים
- **עדכון handleCommand()** להוסיף:
  - `onNavigateBack` (פרמטר חדש)
  - `onNavigateToPage` (פרמטר חדש)
  - זיהוי פקודות גלובליות לפני פקודות ספציפיות לדף
- **עדכון _handleFeedbacksCommands()** להוסיף:
  - כנס למשוב ראשון/אחרון
  - חפש משוב לפי שם (עם חילוץ שם)
  - סגור משוב
- **עדכון _handleStatisticsCommands()** להוסיף:
  - כמה משובים יש (סך כל)
  - כמה משובים יש לקורס מדריכים
  - כמה משובים יש בתרגיל
  - אפס סינונים
  - סנן לפי תאריך (placeholder)

### main.dart
- **הוספת פונקציות:**
  - `_handleNavigateBack()` - ניווט אחורה גלובלי
  - `_handleNavigateToPage(int)` - מעבר לדף ספציפי
- **עדכון _handleFeedbackFilter()** להוסיף:
  - פתיחת משוב ראשון (action_open_first_feedback)
  - פתיחת משוב אחרון (action_open_last_feedback)
  - חיפוש משוב לפי שם (search_feedback_[name])
  - פתיחת משוב כללי (action_open_feedback)
- **עדכון _handleStatisticsFilter()** להוסיף:
  - ספירת משובים (action_count_feedbacks)
  - ספירת משובי קורס מדריכים (action_count_instructor_feedbacks)
  - ספירת משובי תרגיל (action_count_exercise_feedbacks)
  - איפוס סינונים (action_clear_filters)
  - פתיחת בורר תאריך (action_filter_by_date)

---

## 📋 תיעוד מלא

לרשימה מלאה של כל הפקודות הקוליות, ראה:
👉 **[VOICE_COMMANDS.md](VOICE_COMMANDS.md)**

---

## 🧪 איך לבדוק?

1. הרץ את האפליקציה: `flutter run -d chrome`
2. פתח Chrome DevTools (F12) → Console
3. לחץ על כפתור המיקרופון (שמאל למטה)
4. נסה פקודות:

```
✅ "חפש משוב של יוסי"
✅ "כמה משובים יש"
✅ "כמה משובים יש לקורס מדריכים"
✅ "אפס סינונים"
✅ "כנס למשוב האחרון"
✅ "לך לדף הבית"
✅ "חזור אחורה"
```

5. צפה בלוגים ב-Console:
```
🎯 Handling command: "חפש משוב של יוסי" on page 2
📝 Processing feedbacks command: "חפש משוב של יוסי"
✅ Intent: Search feedback for: יוסי
```

---

## 🎨 דוגמאות שימוש

### דוגמה 1: חיפוש מהיר
```
אתה בדף המשובים
🎤 "חפש משוב של דני"
→ המערכת מחפשת "דני" בכל המשובים
→ אם נמצא אחד → פותחת אותו
→ אם נמצאו מספר → מציגה "נמצאו 3 משובים עבור דני"
```

### דוגמה 2: ניווט מהיר
```
אתה בדף כלשהו
🎤 "לך לדף הבית"
→ מעבר לדף הבית
🎤 "תראה לי את כל המשובים"
→ מעבר לדף משובים
🎤 "פתח סטטיסטיקה"
→ מעבר לסטטיסטיקה
```

### דוגמה 3: חישובים
```
אתה בדף סטטיסטיקה
🎤 "כמה משובים יש"
→ "סך הכל: 47 משובים"
🎤 "כמה משובים יש לקורס מדריכים"
→ "משובי קורס מדריכים: 12"
```

### דוגמה 4: איפוס והגדרה מחדש
```
אתה בדף סטטיסטיקה עם מספר סינונים פעילים
🎤 "אפס סינונים"
→ כל הסינונים מתאפסים
→ הודעה: "כל הסינונים אופסו"
```

---

## 🔄 מה לא השתנה?

- פקודות קיימות ממשיכות לעבוד כרגיל
- ממשק המשתמש נשאר זהה
- אין צורך בהגדרות נוספות או packages חדשים

---

## 🚀 בעיות ידועות

1. **פקודות מילוי טופס** לא מיושמות עדיין:
   - "תמלא הערה"
   - "שמור משוב"
   - דורשות אינטגרציה עם TextField ב-FeedbackFormPage

2. **זיהוי שמות עם רווחים** עשוי לדרוש שיפור:
   - "חפש משוב של בן דוד" → יחלץ רק "בן"
   - פתרון זמני: השתמש בשם פרטי בלבד

---

## 📊 סטטיסטיקות

- **שורות קוד שהשתנו:** ~300 שורות
- **פקודות חדשות:** 15+
- **זמן פיתוח:** 2 שעות
- **קבצים שונו:** 2 (voice_assistant.dart, main.dart)
- **תיעוד נוסף:** 2 קבצים (VOICE_COMMANDS.md, זה)

---

## ✅ מה הבא?

- [ ] הוספת פקודות מילוי טופס
- [ ] שיפור חילוץ שמות עם רווחים
- [ ] הוספת פקודות למחיקת משובים (admin בלבד)
- [ ] הוספת פקודות לעריכת משובים קיימים
- [ ] תמיכה בפקודות בערבית (אם רלוונטי)

---

**גרסה:** 2.0  
**תאריך:** דצמבר 2025  
**מחבר:** GitHub Copilot  
